<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Дашборды</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', path='css/base.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script> <!-- Добавлено -->
</head>
<body> 
    <header>
        <div id="header">
            <div id="header-dashboard-list">
                <ul >
                    <a href="http://127.0.0.1:8000/pages/dfo" class="btn">ДФО</a>
                    <a href="http://127.0.0.1:8000/pages/centr" class="btn">Центр</a>
                    <a href="http://127.0.0.1:8000/pages/siberia" class="btn">Сибирь</a>
                </ul>
            </div>  
        </div>
        <h2>Дашборд ДФО — График по датам</h2>
        <div>
            <label for="start-date">Start date:</label>
                <input
                    type="date"
                    id="start-date"
                    name="batch_date_start"
                    value="{{ request.query_params.get('batch_date_start', '') }}"
                />

                <label for="end-date">End date:</label>
                <input
                    type="date"
                    id="end-date"
                    name="batch_date_end"
                    value="{{ request.query_params.get('batch_date_end', '') }}"
                />

                <div id="header-dashboard-list">
                    <a id="search-link" href="#" class="btn">Поиск</a>
                </div>

                <script>
                    function updateSearchLink() {
                        const startDate = document.getElementById('start-date').value;
                        const endDate = document.getElementById('end-date').value;
                        let url = new URL("http://localhost:8000/pages/dfo/search/");
                        if (startDate) url.searchParams.append("batch_date_start", startDate);
                        if (endDate) url.searchParams.append("batch_date_end", endDate);
                        document.getElementById('search-link').href = url;
                    }

                    // Обновляем ссылку при изменении дат
                    document.getElementById('start-date').addEventListener('change', updateSearchLink);
                    document.getElementById('end-date').addEventListener('change', updateSearchLink);

                    // Инициализация при загрузке
                    updateSearchLink();
                </script>                
        </div>    
    </header>
    <main id="main"> 
        {% block content %}   
        {% endblock %}
    </main>
</body>
</html>

